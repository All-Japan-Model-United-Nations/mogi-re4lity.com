---
sidebar_position: 4
tags: [Unstable]
---

# 渉外展開用タブ

このページでは、36thで総務が使用していた個人情報シートのうちのタブの一つ、渉外展開用(メール配信)(内部用サイトで閲覧可能)について解説します。<br />
全データシートのデータのうち、記入いただいたメールアドレスに対し、今後の大会におけるお知らせメールを受信することを希望しますか？という設問に「希望する」を回答したものに絞り込んで表示するタブです。<br />
このタブの表示を別シートにimportrangeして渉外の全メンバーに見せていました。<br />


## 構造(概観)

全データタブのデータから、AF列の回答が希望するのものをフィルタして表示させています。<br />
このシートそのものをを渉外に共有すると、別のタブも見えてしまうため、別個のスプレッドシートを作成し、そこにこのタブをimportrangeして共有します。

# 作成


- 全データのタブと同一のスプレッドシート上で新規タブを作成し、渉外展開用(メール配信)と名前を付ける
- A1セルに```=QUERY(INDIRECT("'【全データ】一次事務編アプライ回答'!A:AY"), "SELECT Col9, Col10, Col11, Col12, Col13, Col14, Col15, Col32 WHERE Col32 = '希望する'"))```と入力する
    - 32列目の回答で絞り込んだ後、列の番号を指定して特定の部分のみを表示している。
    - 全データタブの構造が変わると列番号をうち直す必要があるので注意。
        - 36thでは意図せず電話番号とかが見えていた状態になってしまったやらかしを経験しています(1敗)
- 新規のスプレッドシートを作成し、```=IMPORTRANGE("個人情報シートのID","渉外展開用(メール配信)!A1:Z")```と入力し、権限を付与した後に意図した結果が表示されることを確認する
    - 事務局員の情報を収集したデータから渉外のメンバーのメアドを抽出し、権限を閲覧者に設定して共有する
        - 編集者にすると表示する行の範囲を変更することができてしまい、閲覧権限の意味を為さなくなります